!function(){"use strict";const e=document.querySelector(".profile__edit-button"),t=document.querySelector(".profile__add-button"),s={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},n=document.querySelector(".popup__form_type_profile"),o=document.querySelector(".profile"),r=(o.querySelector(".profile__name"),o.querySelector(".profile__title"),n.querySelector(".form__input_type_profile-name")),i=n.querySelector(".form__input_type_profile-title"),l=document.querySelector(".popup__form_type_add-place");function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}document.querySelector(".popup_type_add-place"),document.querySelector(".popup_type_image-prev"),document.querySelector(".cards").querySelector(".cards__list");class c{constructor(e){a(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),a(this,"_handleOverlayClose",(e=>{e.target.classList.contains("popup")&&this.close()})),this._popupElement=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("click",this._handleOverlayClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._handleOverlayClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleOverlayClose(e){e.target.classList.contains("popup")&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("click",this.close)}}class u extends c{constructor(e,t){var s,n;super(e),n=()=>{super.close()},(s="close")in this?Object.defineProperty(this,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[s]=n,this._formElement=this._popupElement.querySelector(".popup__form"),this._submitHandler=t}_getInputValues(){this._inputList=[...this._formElement.querySelectorAll(".form__input")];const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this._formElement.reset(),this.close()})),super.setEventListeners()}}class _{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInputs(){return this._inputList.some((e=>!e.validity.valid))}_disableButton(){this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass)}enableButton(){this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)}_toggleButton(){this._hasInvalidInputs()?this._disableButton():this.enableButton()}_setEventListeners(){this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._button=this._form.querySelector(this._submitButtonSelector),this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetFormButton(){this._disableButton()}hideErrors(){this._inputList.forEach((e=>{this._hideInputError(e)}))}}class p{constructor(e,t,s){this._text=e.name,this._link=e.link,this._selector=t,this._handleCardClick=s}_getCloneFromTemplate(){return document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0)}_handleLikeButton(e){e.target.classList.toggle("card__like-button_active")}_setEventListeners(){this._element.addEventListener("click",(e=>{e.target===this._likeButton&&this._handleLikeButton(e),e.target===this._deleteButton&&e.currentTarget.remove(),e.target===this._image&&this._handleCardClick(e)}))}generateCard(){return this._element=this._getCloneFromTemplate(),this._image=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._element.querySelector(".card__title").textContent=this._text,this._image.src=this._link,this._image.alt="A beautiful scene in ".concat(this._text),this._setEventListeners(),this._element}}const d=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}render(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:e=>h(e)},".cards__list");function h(e){const t=function(e){return new p(e,"#card-template",(()=>{E.open(e.link,e.name)})).generateCard()}(e);d.addItem(t)}d.render();const m=new _(s,n),y=new _(s,l);m.enableValidation(),y.enableValidation();const b=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}}({nameSelector:".profile__name",jobSelector:".profile__title"}),f=new u(".popup_type_edit-profile",(e=>{b.setUserInfo(e.name,e.title)}));f.setEventListeners();const v=new u(".popup_type_add-place",(e=>{h(e),y.resetFormButton()}));v.setEventListeners();const E=new class extends c{constructor(e){super(e)}open(e,t){this._popupImage=this._popupElement.querySelector(".popup__image"),this._popupImage.src=e,this._popupImage.alt="A beautiful view of ".concat(t),this._popupElement.querySelector(".popup__caption").textContent=t,super.open()}}(".popup_type_image-prev");E.setEventListeners(),e.addEventListener("click",(()=>{const e=b.getUserInfo();r.value=e.name,i.value=e.job,m.hideErrors(),m.enableButton(),f.open()})),t.addEventListener("click",(()=>{v.open(),y.hideErrors()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cURMLENBQzVCTCxhQUFjLGlCQUNkQyxZQUFhLG9CQU9UTSxFQUFZLElBQUk1RixFQUFjLDRCQUE2QitDLElBQy9EcUMsRUFBU08sWUFBWTVDLEVBQUtwQyxLQUFNb0MsRUFBSzhDLFVBRXZDRCxFQUFVN0Ysb0JBRVYsTUFBTStGLEVBQWUsSUFBSTlGLEVBQWMseUJBQTBCK0MsSUFDL0RnQyxFQUFXaEMsR0FDWG9DLEVBQWlCdkMscUJBRW5Ca0QsRUFBYS9GLG9CQUViLE1BQU1rRixFQUFhLElHcEZaLGNBQTZCckcsRUFDbENDLFlBQVlDLEdBQ1ZvQixNQUFNcEIsR0FHUlUsS0FBS3VHLEVBQU9DLEdBQ1YvRyxLQUFLZ0gsWUFBY2hILEtBQUtLLGNBQWN2QixjQUFjLGlCQUNwRGtCLEtBQUtnSCxZQUFZL0IsSUFBTTZCLEVBQ3ZCOUcsS0FBS2dILFlBQVk5QixJQUFqQiw4QkFBOEM2QixHQUM5Qy9HLEtBQUtLLGNBQWN2QixjQUFjLG1CQUFtQjhELFlBQWNtRSxFQUNsRTlGLE1BQU1WLFNIMEU0QiwwQkFDdEN5RixFQUFXbEYsb0JBS1hsQyxFQUFrQjZCLGlCQUFpQixTQUFTLEtBQzFDLE1BQU13RyxFQUFPZCxFQUFTSyxjQUN0QmhILEVBQVVtQyxNQUFRc0YsRUFBS3ZGLEtBQ3ZCakMsRUFBV2tDLE1BQVFzRixFQUFLUixJQUN4QlIsRUFBcUJyQyxhQUNyQnFDLEVBQXFCMUMsZUFDckJvRCxFQUFVcEcsVUFHWnhCLEVBQWUwQixpQkFBaUIsU0FBUyxLQUN2Q29HLEVBQWF0RyxPQUNiMkYsRUFBaUJ0QyxnQiIsInNvdXJjZXMiOlsid2VicGFjazovL3kvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3kvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3kvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3kvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9wcm9maWxlXCIpO1xuY29uc3QgcHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZVwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlVGl0bGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBpbnB1dE5hbWUgPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfcHJvZmlsZS1uYW1lXCIpO1xuY29uc3QgaW5wdXRUaXRsZSA9IHByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9wcm9maWxlLXRpdGxlXCIpO1xuY29uc3QgcGxhY2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV90eXBlX2FkZC1wbGFjZVwiKTtcblxuY29uc3QgYWRkUGxhY2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtcGxhY2VcIik7XG5jb25zdCBpbWdQcmV2TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfaW1hZ2UtcHJldlwiKTtcblxuY29uc3QgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xuY29uc3QgY2FyZExpc3QgPSBjYXJkcy5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5cbmV4cG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgZWRpdFByb2ZpbGVCdXR0b24sXG4gIGFkZFBsYWNlQnV0dG9uLFxuICB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMsXG4gIHByb2ZpbGVGb3JtLFxuICBwcm9maWxlLFxuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZVRpdGxlLFxuICBpbnB1dE5hbWUsXG4gIGlucHV0VGl0bGUsXG4gIHBsYWNlRm9ybSxcbiAgYWRkUGxhY2VNb2RhbCxcbiAgaW1nUHJldk1vZGFsLFxuICBjYXJkTGlzdCxcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG59O1xuIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlT3ZlcmxheUNsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICB9XG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgfVxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgX2hhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgLy9jb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMgYW5kIHJldHVybnMgdGhhdCBkYXRhIGFzIGFuIG9iamVjdC5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vSXQgbW9kaWZpZXMgdGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgcGFyZW50IG1ldGhvZC4gVGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZVxuICAgIC8vUG9wdXBXaXRoRm9ybSBjbGFzcyBoYXMgdG8gYWRkIHRoZSBzdWJtaXQgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybSBhbmQgdGhlXG4gICAgLy9jbGljayBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbi5cbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvLyB0aGlzLl9zdWJtaXRIYW5kbGVyKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcih0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuICBjbG9zZSA9ICgpID0+IHtcbiAgICAvL0l0IG1vZGlmaWVzIHRoZSBjbG9zZSgpIHBhcmVudCBtZXRob2QgaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGZvcm0gb25jZSB0aGUgcG9wdXAgaXMgY2xvc2VkLlxuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH07XG59XG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZ3VyYXRpb25zLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlndXJhdGlvbnMuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZ3VyYXRpb25zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWd1cmF0aW9ucy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZ3VyYXRpb25zLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlndXJhdGlvbnMuZXJyb3JDbGFzcztcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXRzKCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cblxuICBlbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXRzKCkpIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRGb3JtQnV0dG9uKCkge1xuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgfVxuXG4gIGhpZGVFcnJvcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBzZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrKSB7XG4gICAgdGhpcy5fdGV4dCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICB9XG5cbiAgX2dldENsb25lRnJvbVRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlQnV0dG9uKGV2dCkge1xuICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gdGhpcy5fbGlrZUJ1dHRvbikge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKGV2dCk7XG4gICAgICB9XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gdGhpcy5fZGVsZXRlQnV0dG9uKSB7XG4gICAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LnJlbW92ZSgpO1xuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IHRoaXMuX2ltYWdlKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayhldnQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRDbG9uZUZyb21UZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2ltYWdlLmFsdCA9IGBBIGJlYXV0aWZ1bCBzY2VuZSBpbiAke3RoaXMuX3RleHR9YDtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuIiwiLy8vLy8gSW1wb3J0aW5nIHN0eWxlcyBmb3Igd2VicGFjayB0byBjb25uZWN0XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG4vLy8vSW1wb3J0c1xuaW1wb3J0IHtcbiAgaW5pdGlhbENhcmRzLFxuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgYWRkUGxhY2VCdXR0b24sXG4gIHZhbGlkYXRpb25Db25maWd1cmF0aW9ucyxcbiAgcHJvZmlsZUZvcm0sXG4gIGlucHV0TmFtZSxcbiAgaW5wdXRUaXRsZSxcbiAgcGxhY2VGb3JtLFxuICBjYXJkTGlzdCxcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIjtcblxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcblxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcblxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkXCI7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8qICAgSW5pdGlhbCBDYXJkIENyZWF0aW9uICAgKi9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuY29uc3QgcGxhY2VzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGRhdGEpID0+IHJlbmRlckNhcmQoZGF0YSksXG4gIH0sXG4gIFwiLmNhcmRzX19saXN0XCJcbik7XG5cbnBsYWNlc1NlY3Rpb24ucmVuZGVyKCk7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChkYXRhLCBjYXJkVGVtcGxhdGVTZWxlY3RvciwgKCkgPT4ge1xuICAgIGltYWdlUG9wdXAub3BlbihkYXRhLmxpbmssIGRhdGEubmFtZSk7XG4gIH0pO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBnZW5lcmF0ZUNhcmQoZGF0YSk7XG4gIHBsYWNlc1NlY3Rpb24uYWRkSXRlbShlbGVtZW50KTtcbn1cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vKiAgICAgRm9ybSBWYWxpZGF0aW9uIEluc3RhbnRpYXRpb24gICAgKi9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMsXG4gIHByb2ZpbGVGb3JtXG4pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWd1cmF0aW9ucywgcGxhY2VGb3JtKTtcblxucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxufSk7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vKiAgICAgUG9wdXAgSW5zdGFudGlhdGlvbiAgICAqL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGVcIiwgKGRhdGEpID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YS5uYW1lLCBkYXRhLnRpdGxlKTtcbn0pO1xuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYWRkLXBsYWNlXCIsIChkYXRhKSA9PiB7XG4gIHJlbmRlckNhcmQoZGF0YSk7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRGb3JtQnV0dG9uKCk7XG59KTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGVfaW1hZ2UtcHJldlwiKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBFdmVudCBMaXN0ZW5lcnNcbi8vLy8vLy8vLy8vLy8vLy8vL1xuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IGluZm8ubmFtZTtcbiAgaW5wdXRUaXRsZS52YWx1ZSA9IGluZm8uam9iO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci5oaWRlRXJyb3JzKCk7XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZUJ1dHRvbigpO1xuICBlZGl0UG9wdXAub3BlbigpO1xufSk7XG5cbmFkZFBsYWNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG4gIGFkZEZvcm1WYWxpZGF0b3IuaGlkZUVycm9ycygpO1xufSk7XG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYikge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50ID0gam9iO1xuICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgb3BlbihpbWFnZSwgY2FwdGlvbikge1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBpbWFnZTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGBBIGJlYXV0aWZ1bCB2aWV3IG9mICR7Y2FwdGlvbn1gO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpLnRleHRDb250ZW50ID0gY2FwdGlvbjtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJlZGl0UHJvZmlsZUJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZFBsYWNlQnV0dG9uIiwidmFsaWRhdGlvbkNvbmZpZ3VyYXRpb25zIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwcm9maWxlRm9ybSIsInByb2ZpbGUiLCJpbnB1dE5hbWUiLCJpbnB1dFRpdGxlIiwicGxhY2VGb3JtIiwiUG9wdXAiLCJjb25zdHJ1Y3RvciIsInBvcHVwU2VsZWN0b3IiLCJldnQiLCJrZXkiLCJ0aGlzIiwiY2xvc2UiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIl9wb3B1cEVsZW1lbnQiLCJiaW5kIiwib3BlbiIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRIYW5kbGVyIiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZ3VyYXRpb25zIiwiZm9ybUVsZW1lbnQiLCJfZm9ybSIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXRzIiwic29tZSIsIl9kaXNhYmxlQnV0dG9uIiwiX2J1dHRvbiIsImRpc2FibGVkIiwiZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvbiIsIl9zZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldEZvcm1CdXR0b24iLCJoaWRlRXJyb3JzIiwiQ2FyZCIsImRhdGEiLCJzZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsIl90ZXh0IiwiX2xpbmsiLCJsaW5rIiwiX3NlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9nZXRDbG9uZUZyb21UZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsInRvZ2dsZSIsIl9lbGVtZW50IiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiY3VycmVudFRhcmdldCIsIl9pbWFnZSIsImdlbmVyYXRlQ2FyZCIsInNyYyIsImFsdCIsInBsYWNlc1NlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVyIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwicmVuZGVyQ2FyZCIsImVsZW1lbnQiLCJpbWFnZVBvcHVwIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsImVkaXRQb3B1cCIsInRpdGxlIiwiYWRkQ2FyZFBvcHVwIiwiaW1hZ2UiLCJjYXB0aW9uIiwiX3BvcHVwSW1hZ2UiLCJpbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==