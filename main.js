!function(){"use strict";const e=document.querySelector(".profile__edit-button"),t=document.querySelector(".profile__add-button"),s={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},r=document.querySelector(".popup__form_type_profile"),i=r.querySelector(s.submitButtonSelector),n=document.querySelector(".profile"),o=(n.querySelector(".profile__name"),n.querySelector(".profile__title"),r.querySelector(".form__input_type_profile-name")),a=r.querySelector(".form__input_type_profile-title"),l=document.querySelector(".popup__form_type_add-place"),c=(document.querySelector(".popup_type_add-place"),document.querySelector(".popup_type_image-prev"),document.querySelector(".profile__image-container")),_=document.querySelector(".popup__form_type_avatar"),h=_.querySelector(s.submitButtonSelector),d=l.querySelector(s.submitButtonSelector),u=document.createElement("img"),p=document.querySelector(".profile__image-container");function m(e,t){e.textContent=t}function v(e,t){e.reset(),t.close()}function f(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class C{constructor(e){f(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),f(this,"_handleOverlayClose",(e=>{e.target.classList.contains("popup")&&this.close()})),this._popupElement=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("click",this._handleOverlayClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._handleOverlayClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleOverlayClose(e){e.target.classList.contains("popup")&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("click",this.close)}}class b extends C{constructor(e,t){var s,r;super(e),r=()=>{super.close()},(s="close")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._formElement=this._popupElement.querySelector(".popup__form"),this._submitHandler=t}_getInputValues(){this._inputList=[...this._formElement.querySelectorAll(".form__input")];const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues())})),super.setEventListeners()}}class k{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInputs(){return this._inputList.some((e=>!e.validity.valid))}_disableButton(){this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass)}enableButton(){this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)}_toggleButton(){this._hasInvalidInputs()?this._disableButton():this.enableButton()}_setEventListeners(){this._inputList=[...this._form.querySelectorAll(this._inputSelector)],this._button=this._form.querySelector(this._submitButtonSelector),this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetFormButton(){this._disableButton()}hideErrors(){this._inputList.forEach((e=>{this._hideInputError(e)}))}}class y{constructor(e,t,s,r){let{handleCardClick:i,handleDeleteCard:n,handleLikeCard:o}=s;this._text=e.name,this._link=e.link,this._selector=t,this._handleCardClick=i,this._handleDeleteCard=n,this._handelLikeCard=o,this._id=e._id,this._userId=r,this._ownerId=e.owner._id,this._likes=e.likes}_getCloneFromTemplate(){return document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0)}_handleLikeButton(e){e.target.classList.toggle("card__like-button_active"),this._handelLikeCard(this._id)}_setEventListeners(){this._element.addEventListener("click",(e=>{e.target===this._likeButton&&this._handleLikeButton(e),e.target===this._deleteButton&&this._handleDeleteCard(this._id),e.target===this._image&&this._handleCardClick(e)}))}removeCard(){this._element.remove(),this._element=null}likeCard(e){this._likeButton.classList.add("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}dislikeCard(e){this._likeButton.classList.remove("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}generateCard(){return this._element=this._getCloneFromTemplate(),this._image=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._element.querySelector(".card__title").textContent=this._text,this._image.src=this._link,this._image.alt="A beautiful scene in ".concat(this._text),this._deleteButton=this._element.querySelector(".card__delete-button"),this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this._likeCount=this._element.querySelector(".card__like-count"),this._likeCount.textContent=this._likes.length,this.isLiked()&&this.likeCard(this._likes),this._setEventListeners(),this._element}}const E=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}setUserInfo(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}setUserAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}createCard(e){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}dislikeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"}).then((e=>e.ok&&e.json())).catch((e=>console.log(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-1",headers:{authorization:"2aae8d26-8315-4517-953d-28905b81f143","Content-Type":"application/json"}}),g=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>L(e)},".cards__list");let S;function L(e){const t=function(e){const t=new y(e,"#card-template",{handleCardClick:()=>{j.open(e.link,e.name)},handleDeleteCard:e=>{A.open(),A.setAction((()=>{E.deleteCard(e).then((e=>{console.log("card is deleted",e),t.removeCard()}))}))},handleLikeCard:e=>{t.isLiked()?E.dislikeCard(e).then((e=>{t.dislikeCard(e.likes),console.log("card is disliked",e)})):E.likeCard(e).then((e=>{t.likeCard(e.likes),console.log("card is liked",e)})),t.isLiked()}},S);return t.generateCard()}(e);g.addItem(t)}u.alt="User's Profile Pic",u.classList.add("profile__image"),Promise.all([E.getInitialCards(),E.getUserInfo()]).then((e=>{let[t,s]=e;S=s._id,g.renderItems(t),U.setUserInfo(s.name,s.about),p.prepend(u),U.setUserAvatar(u,s.avatar)}));const q=new k(s,r),I=new k(s,l),B=new k(s,_);q.enableValidation(),I.enableValidation(),B.enableValidation();const U=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}setUserAvatar(e,t){this._avatar=e,this._avatar.src=t}}({nameSelector:".profile__name",jobSelector:".profile__title",avatarSelector:".profile__image"}),w=new b(".popup_type_edit-profile",(e=>{m(i,"Saving..."),E.setUserInfo(e.name,e.title).then((e=>{m(i,"Saving"),U.setUserInfo(e.name,e.about),v(r,w)}))}));w.setEventListeners();const x=new b(".popup_type_add-place",(e=>{m(d,"Creating..."),E.createCard(e).then((e=>{L(e),m(d,"Create"),v(l,x)})),I.resetFormButton()}));x.setEventListeners();const j=new class extends C{constructor(e){super(e)}open(e,t){this._popupImage=this._popupElement.querySelector(".popup__image"),this._popupImage.src=e,this._popupImage.alt="A beautiful view of ".concat(t),this._popupElement.querySelector(".popup__caption").textContent=t,super.open()}}(".popup_type_image-prev");j.setEventListeners();const A=new class extends C{setAction(e){this._submitHandler=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(),this.close()})),super.setEventListeners()}}(".popup_type_delete-card");A.setEventListeners();const O=new b(".popup_type_avatar",(e=>{m(h,"Saving avatar..."),E.setUserAvatar(e.link).then((e=>{U.setUserAvatar(u,e.avatar),m(h,"Save"),v(_,O)}))}));O.setEventListeners(),e.addEventListener("click",(()=>{const e=U.getUserInfo();o.value=e.name,a.value=e.job,q.hideErrors(),q.enableButton(),w.open()})),t.addEventListener("click",(()=>{x.open(),I.hideErrors()})),c.addEventListener("click",(()=>{O.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8veS8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8veS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8veS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8veS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8veS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3kvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3kvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly95Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8veS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5jb25zdCBhZGRQbGFjZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZ3VyYXRpb25zID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX3R5cGVfcHJvZmlsZVwiKTtcblxuY29uc3QgZWRpdFN1Ym1pdEJ1dHRvbiA9IHByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIHZhbGlkYXRpb25Db25maWd1cmF0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvclxuKTtcblxuY29uc3QgcHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZVwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlVGl0bGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBpbnB1dE5hbWUgPSBwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfcHJvZmlsZS1uYW1lXCIpO1xuY29uc3QgaW5wdXRUaXRsZSA9IHByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9wcm9maWxlLXRpdGxlXCIpO1xuY29uc3QgcGxhY2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV90eXBlX2FkZC1wbGFjZVwiKTtcblxuY29uc3QgYWRkUGxhY2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9hZGQtcGxhY2VcIik7XG5jb25zdCBpbWdQcmV2TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfaW1hZ2UtcHJldlwiKTtcblxuY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5jb25zdCBhdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWNvbnRhaW5lclwiKTtcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX3R5cGVfYXZhdGFyXCIpO1xuY29uc3QgYXZhdGFyU3VibWl0QnV0dG9uID0gYXZhdGFyRm9ybS5xdWVyeVNlbGVjdG9yKFxuICB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3Jcbik7XG5jb25zdCBhZGRQbGFjZVN1Ym1pdEJ1dHRvbiA9IHBsYWNlRm9ybS5xdWVyeVNlbGVjdG9yKFxuICB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3Jcbik7XG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuY29uc3QgcHJvZmlsZUltYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9faW1hZ2UtY29udGFpbmVyXCJcbik7XG5cbmV4cG9ydCB7XG4gIHByb2ZpbGVJbWFnZSxcbiAgcHJvZmlsZUltYWdlQ29udGFpbmVyLFxuICBhdmF0YXIsXG4gIGF2YXRhckZvcm0sXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxuICBhZGRQbGFjZUJ1dHRvbixcbiAgdmFsaWRhdGlvbkNvbmZpZ3VyYXRpb25zLFxuICBwcm9maWxlRm9ybSxcbiAgcHJvZmlsZSxcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVUaXRsZSxcbiAgaW5wdXROYW1lLFxuICBpbnB1dFRpdGxlLFxuICBwbGFjZUZvcm0sXG4gIGFkZFBsYWNlTW9kYWwsXG4gIGltZ1ByZXZNb2RhbCxcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG4gIGVkaXRTdWJtaXRCdXR0b24sXG4gIGF2YXRhclN1Ym1pdEJ1dHRvbixcbiAgYWRkUGxhY2VTdWJtaXRCdXR0b24sXG59O1xuIiwiZXhwb3J0IGZ1bmN0aW9uIGltcHJvdmVVSShlbGVtZW50LCB0ZXh0KSB7XG4gIGVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRBbmRDbG9zZUZvcm0oZm9ybSwgcG9wdXApIHtcbiAgZm9ybS5yZXNldCgpO1xuICBwb3B1cC5jbG9zZSgpO1xufVxuIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlT3ZlcmxheUNsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICB9XG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgfVxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgX2hhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgLy9jb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMgYW5kIHJldHVybnMgdGhhdCBkYXRhIGFzIGFuIG9iamVjdC5cbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vSXQgbW9kaWZpZXMgdGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgcGFyZW50IG1ldGhvZC4gVGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZVxuICAgIC8vUG9wdXBXaXRoRm9ybSBjbGFzcyBoYXMgdG8gYWRkIHRoZSBzdWJtaXQgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybSBhbmQgdGhlXG4gICAgLy9jbGljayBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbi5cbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgLy8gdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgICAgIC8vIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG4gIGNsb3NlID0gKCkgPT4ge1xuICAgIC8vSXQgbW9kaWZpZXMgdGhlIGNsb3NlKCkgcGFyZW50IG1ldGhvZCBpbiBvcmRlciB0byByZXNldCB0aGUgZm9ybSBvbmNlIHRoZSBwb3B1cCBpcyBjbG9zZWQuXG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfTtcbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlndXJhdGlvbnMsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWd1cmF0aW9ucy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlndXJhdGlvbnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZ3VyYXRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlndXJhdGlvbnMuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWd1cmF0aW9ucy5lcnJvckNsYXNzO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgX2Rpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxuXG4gIGVuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dHMoKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldEZvcm1CdXR0b24oKSB7XG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICB9XG5cbiAgaGlkZUVycm9ycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgc2VsZWN0b3IsXG4gICAgeyBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VDYXJkIH0sXG4gICAgdXNlcklkXG4gICkge1xuICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLl9oYW5kZWxMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gIH1cblxuICBfZ2V0Q2xvbmVGcm9tVGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgX2hhbmRsZUxpa2VCdXR0b24oZXZ0KSB7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIHRoaXMuX2hhbmRlbExpa2VDYXJkKHRoaXMuX2lkKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gdGhpcy5fbGlrZUJ1dHRvbikge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKGV2dCk7XG4gICAgICB9XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gdGhpcy5fZGVsZXRlQnV0dG9uKSB7XG4gICAgICAgIC8vIGV2dC5jdXJyZW50VGFyZ2V0LnJlbW92ZSgpO1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMuX2lkKTtcbiAgICAgIH1cbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9pbWFnZSkge1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soZXZ0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIGxpa2VDYXJkKG5ld0xpa2VzKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIC8vIHRoaXMuX2xpa2VDb3VudC50ZXh0Q29udGVudCA9IG5ld0xpa2VzQ291bnQ7XG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcbiAgICB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gIH1cblxuICBkaXNsaWtlQ2FyZChuZXdMaWtlcykge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAvLyB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSBuZXdMaWtlc0NvdW50O1xuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG4gICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldENsb25lRnJvbVRlbXBsYXRlKCk7XG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgQSBiZWF1dGlmdWwgc2NlbmUgaW4gJHt0aGlzLl90ZXh0fWA7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICAgIHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCAmJlxuICAgICAgKHRoaXMuX2RlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCIpO1xuXG4gICAgdGhpcy5fbGlrZUNvdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRcIik7XG4gICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuXG4gICAgdGhpcy5pc0xpa2VkKCkgJiYgdGhpcy5saWtlQ2FyZCh0aGlzLl9saWtlcyk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLm9rICYmIHJlcy5qc29uKCkpXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiByZXMub2sgJiYgcmVzLmpzb24oKSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLm9rICYmIHJlcy5qc29uKCkpXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKHVybCkge1xuICAgIC8vIFNlbmQgdGhlIGZvbGxvd2luZyBQQVRDSCByZXF1ZXN0IHRvIGNoYW5nZSB0aGUgcHJvZmlsZSBwaWN0dXJlOlxuICAgIC8vIFBBVENIIGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXBJZC91c2Vycy9tZS9hdmF0YXJcbiAgICAvLyBJbiB0aGUgcmVxdWVzdCBib2R5LCBwYXNzIHRoZSBKU09OIHdpdGggYSBzaW5nbGUgcHJvcGVydHksIGF2YXRhci4gVGhpcyBwcm9wZXJ0eSBzaG91bGQgY29udGFpbiBhIGxpbmsgdG8gdGhlIG5ldyBwcm9maWxlIHBpY3R1cmUuIEluIHRoZSBjYXNlIHRoYXQgYW55dGhpbmcgb3RoZXIgdGhhbiBhIGxpbmsgaXMgc2VudCwgdGhlIHNlcnZlciB3aWxsIHJldHVybiBhbiBlcnJvci5cbiAgICAvLyBXaGVuIHRoZSB1c2VyIGhvdmVycyBvdmVyIHRoZWlyIHByb2ZpbGUgcGljdHVyZSwgdGhlIGVkaXQgaWNvbiBzaG91bGQgYXBwZWFyIG9uIGl0OlxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogdXJsLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcy5vayAmJiByZXMuanNvbigpKVxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICB9XG5cbiAgY3JlYXRlQ2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLm9rICYmIHJlcy5qc29uKCkpXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiByZXMub2sgJiYgcmVzLmpzb24oKSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiByZXMub2sgJiYgcmVzLmpzb24oKSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgfVxuXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PiByZXMub2sgJiYgcmVzLmpzb24oKSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjJhYWU4ZDI2LTgzMTUtNDUxNy05NTNkLTI4OTA1YjgxZjE0M1wiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG4iLCIvLy8vLyBJbXBvcnRpbmcgc3R5bGVzIGZvciB3ZWJwYWNrIHRvIGNvbm5lY3RcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbi8vLy9JbXBvcnRzXG5pbXBvcnQge1xuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgYWRkUGxhY2VCdXR0b24sXG4gIHZhbGlkYXRpb25Db25maWd1cmF0aW9ucyxcbiAgcHJvZmlsZUZvcm0sXG4gIGlucHV0TmFtZSxcbiAgaW5wdXRUaXRsZSxcbiAgcGxhY2VGb3JtLFxuICBjYXJkVGVtcGxhdGVTZWxlY3RvcixcbiAgYXZhdGFyLFxuICBhdmF0YXJGb3JtLFxuICBlZGl0U3VibWl0QnV0dG9uLFxuICBhdmF0YXJTdWJtaXRCdXR0b24sXG4gIGFkZFBsYWNlU3VibWl0QnV0dG9uLFxuICBwcm9maWxlSW1hZ2UsXG4gIHByb2ZpbGVJbWFnZUNvbnRhaW5lcixcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xuXG5pbXBvcnQgeyBpbXByb3ZlVUksIHJlc2V0QW5kQ2xvc2VGb3JtIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5cbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5cbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xuaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XG5pbXBvcnQgeyBQb3B1cFdpdGhTdWJtaXQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXRcIjtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLyogICBJbml0aWFsIENhcmQgQ3JlYXRpb24gICAqL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5jb25zdCBwbGFjZXNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICByZW5kZXJlcjogKGRhdGEpID0+IHJlbmRlckNhcmQoZGF0YSksXG4gIH0sXG4gIFwiLmNhcmRzX19saXN0XCJcbik7XG5cbmxldCB1c2VySWQ7XG5cbi8vc2V0dGluZyB1cCBhdmF0YXIgaW1hZ2UgdG8gbG9hZCB0aHJvdWdoIGNhbGxiYWNrIHRvIGF2b2lkIGVtcHR5IGltYWdlIG9uIGxvYWRcbnByb2ZpbGVJbWFnZS5hbHQgPSBcIlVzZXIncyBQcm9maWxlIFBpY1wiO1xucHJvZmlsZUltYWdlLmNsYXNzTGlzdC5hZGQoXCJwcm9maWxlX19pbWFnZVwiKTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKS50aGVuKFxuICAoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG5cbiAgICBwbGFjZXNTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcblxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcblxuICAgIC8vYWRkaW5nIGF2YXRhciBpbWFnZSBvbmx5IGFmdGVyIHN1Y2Nlc3NmdWwgZmV0Y2ggZnJvbSBhcGlcbiAgICBwcm9maWxlSW1hZ2VDb250YWluZXIucHJlcGVuZChwcm9maWxlSW1hZ2UpO1xuXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihwcm9maWxlSW1hZ2UsIHVzZXJEYXRhLmF2YXRhcik7XG4gIH1cbik7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBkYXRhLFxuICAgIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxuICAgIHtcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YS5saW5rLCBkYXRhLm5hbWUpO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZURlbGV0ZUNhcmQ6IChpZCkgPT4ge1xuICAgICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XG5cbiAgICAgICAgZGVsZXRlUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAvLyBzdWJtaXQgbW9kYWxcbiAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhcmQgaXMgZGVsZXRlZFwiLCByZXMpO1xuICAgICAgICAgICAgLy9yZW1vdmUgaXQgZnJvbSBET01cbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlQ2FyZDogKGlkKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcblxuICAgICAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgICAgIC8vZGlzbGlrZSBjYXJkXG4gICAgICAgICAgYXBpLmRpc2xpa2VDYXJkKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQuZGlzbGlrZUNhcmQocmVzLmxpa2VzKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2FyZCBpcyBkaXNsaWtlZFwiLCByZXMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vbGlrZSBjYXJkXG4gICAgICAgICAgYXBpLmxpa2VDYXJkKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQubGlrZUNhcmQocmVzLmxpa2VzKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2FyZCBpcyBsaWtlZFwiLCByZXMpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FyZC5pc0xpa2VkKCk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgLy9jb21wYXJpbmcgdXNlcklkIHRvIGNhcmRJZFxuICAgIHVzZXJJZFxuICApO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGVsZW1lbnQgPSBnZW5lcmF0ZUNhcmQoZGF0YSk7XG4gIHBsYWNlc1NlY3Rpb24uYWRkSXRlbShlbGVtZW50KTtcbn1cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vKiAgICAgRm9ybSBWYWxpZGF0aW9uIEluc3RhbnRpYXRpb24gICAgKi9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMsXG4gIHByb2ZpbGVGb3JtXG4pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWd1cmF0aW9ucywgcGxhY2VGb3JtKTtcblxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMsXG4gIGF2YXRhckZvcm1cbik7XG5cbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLyogICAgIFBvcHVwIEluc3RhbnRpYXRpb24gICAgKi9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsIChkYXRhKSA9PiB7XG4gIGltcHJvdmVVSShlZGl0U3VibWl0QnV0dG9uLCBcIlNhdmluZy4uLlwiKTtcbiAgYXBpLnNldFVzZXJJbmZvKGRhdGEubmFtZSwgZGF0YS50aXRsZSkudGhlbigoZGF0YSkgPT4ge1xuICAgIGltcHJvdmVVSShlZGl0U3VibWl0QnV0dG9uLCBcIlNhdmluZ1wiKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhLm5hbWUsIGRhdGEuYWJvdXQpO1xuICAgIHJlc2V0QW5kQ2xvc2VGb3JtKHByb2ZpbGVGb3JtLCBlZGl0UG9wdXApO1xuICB9KTtcbn0pO1xuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYWRkLXBsYWNlXCIsIChkYXRhKSA9PiB7XG4gIGltcHJvdmVVSShhZGRQbGFjZVN1Ym1pdEJ1dHRvbiwgXCJDcmVhdGluZy4uLlwiKTtcbiAgYXBpLmNyZWF0ZUNhcmQoZGF0YSkudGhlbigocmVzKSA9PiB7XG4gICAgcmVuZGVyQ2FyZChyZXMpO1xuICAgIGltcHJvdmVVSShhZGRQbGFjZVN1Ym1pdEJ1dHRvbiwgXCJDcmVhdGVcIik7XG4gICAgcmVzZXRBbmRDbG9zZUZvcm0ocGxhY2VGb3JtLCBhZGRDYXJkUG9wdXApO1xuICB9KTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldEZvcm1CdXR0b24oKTtcbn0pO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZV9pbWFnZS1wcmV2XCIpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoXCIucG9wdXBfdHlwZV9kZWxldGUtY2FyZFwiKTtcbmRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9hdmF0YXJcIiwgKGRhdGEpID0+IHtcbiAgaW1wcm92ZVVJKGF2YXRhclN1Ym1pdEJ1dHRvbiwgXCJTYXZpbmcgYXZhdGFyLi4uXCIpO1xuICBhcGkuc2V0VXNlckF2YXRhcihkYXRhLmxpbmspLnRoZW4oKHJlcykgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocHJvZmlsZUltYWdlLCByZXMuYXZhdGFyKTtcbiAgICBpbXByb3ZlVUkoYXZhdGFyU3VibWl0QnV0dG9uLCBcIlNhdmVcIik7XG4gICAgcmVzZXRBbmRDbG9zZUZvcm0oYXZhdGFyRm9ybSwgYXZhdGFyUG9wdXApO1xuICB9KTtcbn0pO1xuYXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBFdmVudCBMaXN0ZW5lcnNcbi8vLy8vLy8vLy8vLy8vLy8vL1xuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IGluZm8ubmFtZTtcbiAgaW5wdXRUaXRsZS52YWx1ZSA9IGluZm8uam9iO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci5oaWRlRXJyb3JzKCk7XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZUJ1dHRvbigpO1xuICBlZGl0UG9wdXAub3BlbigpO1xufSk7XG5cbmFkZFBsYWNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG4gIGFkZEZvcm1WYWxpZGF0b3IuaGlkZUVycm9ycygpO1xufSk7XG5cbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIC8vIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IGpvYjtcbiAgfVxuXG4gIC8vc2V0IHVwIHdpdGggYXZhdGFyRWxlbWVudCBwYXJhbWV0ZXIgc28gdGhhdCBpbWFnZSBjYW4gYmUgYWRkZWQgdG8gRE9NIG9ubHkgYWZ0ZXIgc3VjY2Vzc2Z1bGx5IGZldGNoZWQgZnJvbSBzZXJ2ZXJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXJFbGVtZW50LCBhdmF0YXIpIHtcbiAgICB0aGlzLl9hdmF0YXIgPSBhdmF0YXJFbGVtZW50O1xuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKGltYWdlLCBjYXB0aW9uKSB7XG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGltYWdlO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gYEEgYmVhdXRpZnVsIHZpZXcgb2YgJHtjYXB0aW9ufWA7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIikudGV4dENvbnRlbnQgPSBjYXB0aW9uO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuICAvLyBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gIC8vICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gIC8vICAgLy8gdGhpcy5fc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XG4gIC8vIH1cblxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvbjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImVkaXRQcm9maWxlQnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkUGxhY2VCdXR0b24iLCJ2YWxpZGF0aW9uQ29uZmlndXJhdGlvbnMiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInByb2ZpbGVGb3JtIiwiZWRpdFN1Ym1pdEJ1dHRvbiIsInByb2ZpbGUiLCJpbnB1dE5hbWUiLCJpbnB1dFRpdGxlIiwicGxhY2VGb3JtIiwiYXZhdGFyIiwiYXZhdGFyRm9ybSIsImF2YXRhclN1Ym1pdEJ1dHRvbiIsImFkZFBsYWNlU3VibWl0QnV0dG9uIiwicHJvZmlsZUltYWdlIiwiY3JlYXRlRWxlbWVudCIsInByb2ZpbGVJbWFnZUNvbnRhaW5lciIsImltcHJvdmVVSSIsImVsZW1lbnQiLCJ0ZXh0IiwidGV4dENvbnRlbnQiLCJyZXNldEFuZENsb3NlRm9ybSIsImZvcm0iLCJwb3B1cCIsInJlc2V0IiwiY2xvc2UiLCJQb3B1cCIsImNvbnN0cnVjdG9yIiwicG9wdXBTZWxlY3RvciIsImV2dCIsImtleSIsInRoaXMiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIl9wb3B1cEVsZW1lbnQiLCJiaW5kIiwib3BlbiIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsIl9mb3JtRWxlbWVudCIsIl9zdWJtaXRIYW5kbGVyIiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWd1cmF0aW9ucyIsImZvcm1FbGVtZW50IiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dHMiLCJzb21lIiwiX2Rpc2FibGVCdXR0b24iLCJfYnV0dG9uIiwiZGlzYWJsZWQiLCJlbmFibGVCdXR0b24iLCJfdG9nZ2xlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZW5hYmxlVmFsaWRhdGlvbiIsInJlc2V0Rm9ybUJ1dHRvbiIsImhpZGVFcnJvcnMiLCJDYXJkIiwiZGF0YSIsInNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwiX3RleHQiLCJfbGluayIsImxpbmsiLCJfc2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGVsTGlrZUNhcmQiLCJfaWQiLCJfdXNlcklkIiwiX293bmVySWQiLCJvd25lciIsIl9saWtlcyIsImxpa2VzIiwiX2dldENsb25lRnJvbVRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVMaWtlQnV0dG9uIiwidG9nZ2xlIiwiX2VsZW1lbnQiLCJfbGlrZUJ1dHRvbiIsIl9kZWxldGVCdXR0b24iLCJfaW1hZ2UiLCJyZW1vdmVDYXJkIiwibGlrZUNhcmQiLCJuZXdMaWtlcyIsIl9saWtlQ291bnQiLCJsZW5ndGgiLCJkaXNsaWtlQ2FyZCIsImlzTGlrZWQiLCJsaWtlIiwiZ2VuZXJhdGVDYXJkIiwic3JjIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRVc2VyQXZhdGFyIiwidXJsIiwiY3JlYXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhdXRob3JpemF0aW9uIiwicGxhY2VzU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsInJlbmRlckNhcmQiLCJjYXJkIiwiaW1hZ2VQb3B1cCIsImRlbGV0ZVBvcHVwIiwic2V0QWN0aW9uIiwiUHJvbWlzZSIsImFsbCIsImNhcmRzIiwidXNlckRhdGEiLCJ1c2VySW5mbyIsInByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiam9iIiwiYXZhdGFyRWxlbWVudCIsIl9hdmF0YXIiLCJhdmF0YXJTZWxlY3RvciIsImVkaXRQb3B1cCIsInRpdGxlIiwiYWRkQ2FyZFBvcHVwIiwiaW1hZ2UiLCJjYXB0aW9uIiwiX3BvcHVwSW1hZ2UiLCJhY3Rpb24iLCJhdmF0YXJQb3B1cCIsImluZm8iXSwic291cmNlUm9vdCI6IiJ9